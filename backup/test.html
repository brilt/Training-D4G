<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script><!-- online js used for xlsx reading -->
    <title>Document</title>
</head>
<body >

    <h1>Hello World!</h1>
    <button id="download-file">Display File</button>
    <div id="excel_data"></div>
    
    
</body>
<script>
    const myImage = document.getElementById('img');
    
    
    /*fetch(imageUrl)
    //                         vvvv
    .then(response => response.blob())
    .then(imageBlob => {
        // Then create a local URL for that image and print it 
        const imageObjectURL = URL.createObjectURL(imageBlob);
        console.log(imageObjectURL);
        document.getElementById("img").innerHTML = "<img src="+imageObjectURL+">";
    });*/

    fetch('cleaned-data.xlsx').then(res => { 
        return res.arrayBuffer();
    }).then(res => {
        console.log('file:', res);
        var work_book = XLSX.read(new Uint8Array(res), {
            type: 'array'
        });
        var sheet_name = work_book.SheetNames;

        var sheet_data = XLSX.utils.sheet_to_json(work_book.Sheets[sheet_name[0]], {header:1});

        if(sheet_data.length > 0)
        {
            var table_output = '<table class="table table-striped table-bordered">';

            for(var row = 0; row < sheet_data.length; row++) //parcours chaque ligne de l'excel
            {

                table_output += '<tr>';

                for(var cell = 0; cell < sheet_data[row].length; cell++)
                {

                    if(row == 0) //la premiere ligne sert de header
                    {

                        table_output += '<th>'+sheet_data[row][cell]+'</th>';

                    }
                    else
                    {

                        table_output += '<td>'+sheet_data[row][cell]+'</td>';

                    }

                }

                table_output += '</tr>';

            }

            table_output += '</table>';

            document.getElementById('excel_data').innerHTML = table_output;
        }
    });
    
        
    
</script>